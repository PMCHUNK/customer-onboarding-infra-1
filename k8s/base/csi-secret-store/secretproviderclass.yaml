apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-keyvault-secretprocessor
  namespace: prod
spec:
  provider: azure
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "true"
    userAssignedIdentityID: da9e59f7-93df-4442-9fa1-50d83aae6a0b
    keyvaultName: s00181kvna2
    objects: |
      array:
        - |
          objectName: db-host
          objectType: secret
        - |
          objectName: db-port
          objectType: secret
        - |
          objectName: db-name
          objectType: secret
        - |
          objectName: db-user
          objectType: secret
        - |
          objectName: db-password
          objectType: secret
    tenantId: d7c1df9a-a532-41cf-9c79-0680e0108ca6
  secretObjects:
    - secretName: db-credentials
      type: Opaque
      data:
        - key: DB_HOST
          objectName: db-host
        - key: DB_PORT
          objectName: db-port
        - key: DB_NAME
          objectName: db-name
        - key: DB_USER
          objectName: db-user
        - key: DB_PASSWORD
          objectName: db-password
